!function s(r,a,l){function u(t,e){if(!a[t]){if(!r[t]){var n="function"==typeof require&&require;if(!e&&n)return n(t,!0);if(c)return c(t,!0);var i=new Error("Cannot find module '"+t+"'");throw i.code="MODULE_NOT_FOUND",i}var o=a[t]={exports:{}};r[t][0].call(o.exports,function(e){return u(r[t][1][e]||e)},o,o.exports,s,r,a,l)}return a[t].exports}for(var c="function"==typeof require&&require,e=0;e<l.length;e++)u(l[e]);return u}({1:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var h=e("babylonjs"),f=h.Texture,i=function(e){var t=new h.Engine(e,!0,{},!1),n=new h.Scene(t);n.clearColor=new h.Color4(.5,.8,.8,1);var i=new h.UniversalCamera("camera",new h.Vector3(-5,1.5,4),n);i.rotation=new h.Vector3(.14,8.5,0),i.speed=.4,i.attachControl(e,!0),new h.HemisphericLight("hemiLight",new h.Vector3(-.5,-1,-.5),n).intensity=.2,new h.PointLight("pointLight",new h.Vector3(-3,5,3),n).intensity=.5,new h.PointLight("pointLight_2",new h.Vector3(8,35,22),n).intensity=.5;var o=h.MeshBuilder.CreateBox("box",{width:1,height:1,depth:1},n);o.position.y=1.5,o.rotation=new h.Vector3(Math.PI/4,Math.PI/4,Math.PI/4);var s=h.MeshBuilder.CreateGround("ground",{width:80,height:80,subdivisions:8},n),r=new h.StandardMaterial("red",n);r.diffuseColor=new h.Color3(1,0,0),o.material=r;var a=new h.Texture("grass.jpg",n);a.uScale=8,a.vScale=8,a.wrapU=f.MIRROR_ADDRESSMODE,a.wrapV=f.MIRROR_ADDRESSMODE;var l=new h.StandardMaterial("grass",n);l.diffuseTexture=a;var u=setInterval(function(){a.isReady()&&(s.material=l,n.render(),clearInterval(u))},100),c=new h.Animation("yRot","rotation.y",200,h.Animation.ANIMATIONTYPE_FLOAT,h.Animation.ANIMATIONLOOPMODE_CYCLE),d=[];d.push({frame:0,value:0}),d.push({frame:400,value:2*Math.PI}),c.setKeys(d),n.beginDirectAnimation(o,[c],0,400,!0),this.scene=n};n.default=i},{babylonjs:"babylonjs"}],2:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var s=e("babylonjs"),i=function(){function e(e,t){this.incrementX=1,this.incrementZ=-1,this.xStart=0,this.xEnd=20,this.originalHouse=null,this.houses=[],this.scene=e,this.callback=t,this.clearHouses()}return e.prototype.getOriginalHouse=function(t){var n=this;null!==this.originalHouse?this.executeCallbacks(t,this.originalHouse):s.SceneLoader.Append("./","house.babylon",this.scene,function(){var e=n.scene.getNodeByID("house");e.setEnabled(!1),n.originalHouse=e,n.executeCallbacks(t,e)})},e.prototype.addHouseClone=function(n){var i=this;this.getOriginalHouse(function(e){var t=e.clone("house_"+i.houses.length);i.addAndPosition(t),i.executeCallbacks(n,t)})},e.prototype.addHouseCreateInstance=function(n){var i=this;this.getOriginalHouse(function(e){var t=e.createInstance("house_"+i.houses.length);i.addAndPosition(t),i.executeCallbacks(n,t)})},e.prototype.addAndPosition=function(e){this.houses.push(e),e.position.y=0,e.position.x=this.nextX,e.position.z=this.nextZ,this.nextX+=this.incrementX,this.nextX>=this.xEnd&&(this.nextX=this.xStart,this.nextZ+=this.incrementZ)},e.prototype.executeCallbacks=function(e,t){var n=this;window.setTimeout(function(){void 0!==e&&e(t),void 0!==n.callback&&n.callback()},0)},e.prototype.clearHouses=function(){0<this.houses.length&&(this.houses.forEach(function(e){e.dispose()}),this.houses=[]),this.nextX=this.xStart,this.nextZ=0,this.executeCallbacks()},e.prototype.mergeHouses=function(){var e=s.Mesh.MergeMeshes(this.houses,!0,!0),t=new s.StandardMaterial("red",this.scene);t.diffuseColor=new s.Color3(1,0,0),e.material=t},e.prototype.lodManual=function(){var o=this;this.lodRemoveAll(),this.getOriginalHouse(function(e){var t=e;o._lodRemoveAll(t);var n=s.MeshBuilder.CreateBox(t.id+"_box",{width:.5,height:.7,depth:.5},o.scene),i=new s.StandardMaterial(t.id+"_material",o.scene);i.diffuseColor=new s.Color3(0,0,0),n.material=i,n.setEnabled(!1),t.addLODLevel(15,n)})},e.prototype.lodAutomatic=function(){var n=this;this.getOriginalHouse(function(e){var t=e;n._lodRemoveAll(t),t.simplify([{quality:.6,distance:10,optimizeMesh:!0},{quality:.2,distance:15,optimizeMesh:!0}],!0,s.SimplificationType.QUADRATIC,function(){alert("Done.")})})},e.prototype.lodRemoveAll=function(){var t=this;this.getOriginalHouse(function(e){t._lodRemoveAll(e)})},e.prototype._lodRemoveAll=function(t){t.getLODLevels().forEach(function(e){t.removeLODLevel(e.mesh)})},e}();n.default=i},{babylonjs:"babylonjs"}],3:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function e(e){var t=this;this.alwaysRender=!1,this.forceRenderOnce=!0,this.lastPosition=null,this.lastRotation=null,this.onWinResize=function(){t.scene.getEngine().resize(),t.forceRenderOnce=!0},this.onRender=function(){if(t.isRenderNeeded()){var e=t.scene.activeCamera;t.lastPosition=e.position.clone(),t.lastRotation=e.rotation.clone(),t.forceRenderOnce=!1,t.scene.render()}},(this.scene=e).getEngine().runRenderLoop(this.onRender),window.addEventListener("resize",this.onWinResize)}return e.prototype.isRenderNeeded=function(){if(1==this.alwaysRender||!0===this.forceRenderOnce||0<this.scene.animatables.length)return!0;var e=this.scene.activeCamera;return e.update(),!this.lastPosition.equals(e.position)||!this.lastRotation.equals(e.rotation)||!!this.scene.debugLayer.isVisible()},e}();n.default=i},{}],4:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=e("./CookieCutterSuburbia"),o=e("./SmartRender"),s=e("./HouseBuilder"),r=document.getElementById("renderCanvas"),a=new i.default(r).scene,l=new o.default(a),u=document.getElementById("smartRenderToggle");function c(){u.classList.toggle("toggleOff",!l.alwaysRender)}u.addEventListener("click",function(e){l.alwaysRender=!l.alwaysRender,c()}),c();var d=new s.default(a,function(){l.forceRenderOnce=!0}),h=document.getElementById("housesNumberToAdd");document.getElementById("cloneHouse").addEventListener("click",function(e){e.preventDefault();var t=parseInt(h.value);!function e(){0<t--&&d.addHouseClone(e)}()}),document.getElementById("createInstanceHouse").addEventListener("click",function(e){e.preventDefault();var t=parseInt(h.value);!function e(){0<t--&&d.addHouseCreateInstance(e)}()}),document.getElementById("clearHouses").addEventListener("click",function(e){e.preventDefault(),d.clearHouses()}),document.getElementById("mergeHouses").addEventListener("click",function(e){e.preventDefault(),d.mergeHouses()}),document.getElementById("lodManual").addEventListener("click",function(e){e.preventDefault(),d.lodManual()}),document.getElementById("lodAutomatic").addEventListener("click",function(e){e.preventDefault(),d.lodAutomatic()}),document.getElementById("lodRemoveAll").addEventListener("click",function(e){e.preventDefault(),d.lodRemoveAll()}),document.getElementById("debugLayerToggle").addEventListener("click",function(e){e.preventDefault(),a.debugLayer.isVisible()?a.debugLayer.hide():a.debugLayer.show()})},{"./CookieCutterSuburbia":1,"./HouseBuilder":2,"./SmartRender":3}]},{},[4]);
//# sourceMappingURL=main.js.map
